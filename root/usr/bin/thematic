#!/bin/bash

config=$(< /etc/thematic/$1.conf) || exit 1

niri=$(echo "$config" | grep niri_layout | awk -F'"' '{print $2}') || exit 1
alacritty=$(echo "$config" | grep alacritty_colors | awk -F'"' '{print $2}') || exit 1
nvim=$(echo "$config" | grep nvim_colors | awk -F'"' '{print $2}') || exit 1
theme=$(echo "$config" | grep gtk_theme | awk -F'"' '{print $2}') || exit 1
icons=$(echo "$config" | grep gtk_icons | awk -F'"' '{print $2}') || exit 1
wallpaper=$(echo "$config" | grep wallpaper | awk -F'"' '{print $2}') || exit 1
rofi=$(echo "$config" | grep rofi | awk -F'"' '{print $2}') || exit 1



# apply niri layout
mkdir -p ~/.config/niri
cp /etc/niri/config.kdl -u ~/.config/niri/config.kdl
cp /etc/niri/autostart.kdl -u ~/.config/niri/autostart.kdl
cp /etc/niri/window-rules.kdl -u ~/.config/niri/window-rules.kdl
cp /etc/niri/binds.kdl -u ~/.config/niri/binds.kdl
cp /etc/niri/$niri ~/.config/niri/theme.kdl

# apply alacritty color
mkdir -p ~/.config/alacritty
cp /etc/alacritty/$alacritty ~/.config/alacritty/alacritty.toml

# apply nvim color
mkdir -p ~/.config/nvim
cp /etc/xdg/nvim/$nvim ~/.config/nvim/init.lua

# apply rofi theme
mkdir -p ~/.config/rofi
echo "@theme \"/etc/thematic/$rofi\"" > ~/.config/rofi/color.rasi

# apply gtk theme and icons
gsettings set org.gnome.desktop.interface gtk-theme $theme
gsettings set org.gnome.desktop.interface icon-theme $icons

awww img /usr/share/wallpapers/$wallpaper --transition-type wipe --transition-angle 30 --transition-duration 0.2 --transition-fps 60


